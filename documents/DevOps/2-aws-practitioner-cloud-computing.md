# 2. 클라우드 컴퓨팅

기본적으로 EC2는 가상화라고 하는 기술을 사용해서 AWS에서 관리하고 있습니다. 그리고 AWS에서 관리하고 있는 물리적 호스트 시스템에서 실행이 되기 때문에 EC2 인스턴스를 실제로 가동할 때는 전체 호스트를 내가 다 소유하지 않아도 되죠. 그 대신 `호스트를 다른 여러 인스턴스와 공유해서 사용`을 합니다. 이러한 방식을 우리는 `가상 머신`이라고 하죠.

호스트 머신에서 실행하는 하이퍼바이저라고 하는 것이 가상 머신끼리 서로 물리적인 리소스를 공유하도록 책임을 지고 있어요. 이렇게 `여러 가상머신이 기본적인 하드웨어를 공유하는 것을 "멀티 테넌시"`라고 합니다. 하이퍼바이저는 이러한 멀티 테넌시 조정을 책임지고 이 모든 과정은 AWS에서 관리합니다. 또한 이 하이퍼바이저는 호스트의 리소스를 서로 공유하는 가상 머신이라고 하는 것을 서로 분리해주는 일을 책임지죠. 그 말은 각 `EC2 인스턴스가 서로 격리`가 되어서 안전하다는 뜻입니다. 즉, 서로 리소스를 공유할 수는 있지만 EC2 인스턴스는 그 호스트에 있는 다른 EC2 인스턴스는 전혀 인식하지 못하죠. 말 그대로 `안전하면서도 서로 분리`가 되어 있죠.


## 2_1. Amazon EC2 [인스턴스 유형](https://aws.amazon.com/ec2/instance-types/)

커피숍에 다양한 직원이 있듯 AWS에는 가동하여 AWS 환경에 배포할 수 있는 다양한 유형의 EC2 인스턴스가 있다. 각 인스턴스 유형은 특정 유형의 작업에 최적화되어 있다.

1. 범용 인스턴스
    - 컴퓨팅, 메모리, 네트워킹 리소스를 `균형 있게` 제공
2. 컴퓨팅 최적화 인스턴스
    - `고성능 프로세서`를 활용하는 `컴퓨팅 집약`적인 애플리케이션에 적합
    - 단일 그룹에서 많은 트랜잭션을 처리해야 하는 일괄 처리 워크로드에 사용할 수도 있음.
3. 메모리 최적화 인스턴스
    - `메모리`에서 `대규모 데이터 세트`를 처리하는 워크로드를 위한 빠른 성능 제공 (컴퓨터 프로그램이나 애플리케이션은 스토리지에서 메모리로 로드된 후 실행. 이 사전 로드 프로세스 덕분에 CPU가 컴퓨터 프로그램에 직접 액세스.)
4. 액셀러레이티드 컴퓨팅 인스턴스
    - 하드웨어 액셀러레이터 또는 코프로세서를 사용하여 일부 기능을 CPU에서 실행되는 소프트웨어에서보다 더 효율적으로 수행 (`데이터 처리를 가속화`할 수 있는 구성 요소)
    - 그래픽처리, 부동 소수점 수 계산, 데이터 패턴 일치, 스트리밍
5. 스토리지 최적화 인스턴스
    - 순차적 `읽기 및 쓰기` 액세스가 많이 필요한 워크로드를 위해 설계됨.
    -  **IOPS(초당 입출력 작업 수)**라는 용어는 스토리지 디바이스의 성능을 측정하는 지표. -> 스토리지 최적화 인스턴스는 지연 시간이 짧은 임의 IOPS를 애플리케이션에 제공하도록 설계
    - 분산파일 시스템, 데이터 웨어하우징 애플리케이션에 적합.

---

Q. 각 설명을 Amazon EC2 인스턴스 유형과 연결하십시오.

A.

1. 고성능 데이터베이스에 적합
2. 데이터 웨어하우징 애플리케이션에 적합
3. 컴퓨팅, 메모리, 네트워킹 리소스를 균형 있게 제공
4. 고성능 프로세서 제공
---
1. 메모리 최적화 인스턴스
2. 스토리지 최적화 인스턴스
3. 범용 인스턴스
4. 컴퓨팅 최적화 인스턴스

---

Q. **<span style="color:red">배치 처리 워크로드에 Amazon EC2 인스턴스를 사용하려고 합니다. 가장 적합한 Amazon EC2 인스턴스 유형은 무엇입니까?</span>**

- 범용

- 메모리 최적화

- [x] 컴퓨팅 최적화

- 스토리지 최적화

**※ 배치 처리란?**

컴퓨터가 주기적으로 대량의 반복적인 데이터 작업을 완료하는 데 사용하는 방법

---

## 2_2. Amazon EC2 요금

1. 온디맨드 인스턴스 
- 중단할 수 없는 불규칙한 단기 워크로드가 있는 애플리케이션에 매우 적합
- 1년 이상 지속되는 워크로드에 권장 X / 예약 인스턴스를 사용하는게 비용 절감에 더 효과적
 

2. Amazon EC2 Savings Plans
- 기간 약정(1년 또는 3년)을 통해 비용 절감
- 약정을 초과한 사용량에 대해서는 일반 온디맨드 요금 부과
- 온디맨드 비용에 비해 최대 72%까지 비용 절감
 

3. 예약 인스턴스
- 계정에서 온디맨드 인스턴스를 사용할 때 적용되는 결제 할인 옵션
- 표준은 1년, 3년
- 다음 중 하나를 수행할 때까지는 온디맨드 요금 부과
    - 인스턴스종료
    - 인스턴스 속성(인스턴스 유형, 리전, 테넌시, 플랫폼)과 일치하는 새 예약 인스턴스 구입

4. 스팟 인스턴스
- 시작 및 종료시간이 자유롭거나 중단을 견딜 수 있는 워크로드에 적합
- EC2 Savings Plans와 달리 약정이 필요하지 않음!
- 하지만 스팟 요청을 했는데 Amazon EC2 용량을 사용할 수 없다면 용량을 사용할 수 있을 때까지 요청이 성공하지 못함.
- 미사용 Amazon EC2 컴퓨팅 용량을 사용하며, 온디맨드 요금의 최대 90%까지 비용 절감
 
5. 전용 호스트
- 사용자 전용의 Amazon EC2 인스턴스 용량을 갖춘 물리적 서버
- 모든 EC2 옵션 중에서 가장 비용이 많이 들어감.

---

Q. Amazon EC2 Savings Plans와 스팟 인스턴스의 차이점은 무엇입니까?

A. 

- Amazon EC2 Saving Plans
    - 1년 또는 3년 기간 동안 컴퓨팅 사용량이 일정한 워크로드에 매우 적합합니다. Amazon EC2 Savings Plans를 사용하면 온디맨드 비용에 비해 최대 72%까지 컴퓨팅 비용을 절감할 수 있습니다.
- 스팟 인스턴스
    - 시작 및 종료 시간이 자유롭거나 중단을 견딜 수 있는 워크로드에 적합합니다. 스팟 인스턴스를 사용하면 온디맨드 비용에 비해 최대 90%까지 컴퓨팅 비용을 절감할 수 있습니다. `Amazon EC2 Savings Plans와 달리 스팟 인스턴스에는 계약이나 일정한 컴퓨팅 사용량에 대한 약정이 필요하지 않습니다.`

---

Q. Amazon EC2 예약 인스턴스의 약정 기간 옵션은 무엇입니까? (2개 선택)

A. 1년, 3년

---

Q. 총 6개월 동안 실행되며 중단을 견딜 수 있는 워크로드가 있습니다. 가장 비용 효율적인 Amazon EC2 구매 옵션은 무엇입니까?

A. 스팟 인스턴스

---

## 2_3. Amazon EC2 확장

- 수직 확장 : 실행 중인 장치에 성능을 추가하는 작업

증가하는 수요는 두 가지 방법으로 처리할 수 있습니다. `수직 확장과 수평 확장`입니다. 수직 확장은 실행 중인 장치에 성능을 추가하는 작업으로 일부 사례에서는 도움이 되지만, 생각해 봐야 할 점이 있습니다. 

`고객이 증가하면 엘런 인스턴스가 더 크다고 해서 고객의 주문을 더 빨리 처리하지는 못합니다.` 상황이 엘런이 아닌 고객에게 달려 있기 때문입니다.

    에스프레소 한 잔 주세요 잠깐만요. 유기농인가요? 두유 라떼로 해주시겠어요? 아, 잠시만요 차도 파나요?

**우리에게는 더 많은 엘런이 필요할 것입니다.**

또한, 할 일 없이 쉬고 있는 추가 작업자가 필요 없어지면 집으로 돌려보냅니다. 인스턴스를 중지한다는 뜻이죠. Amazon EC2 Auto Scaling은 수요에 따라 인스턴스를 추가하고 필요 없는 인스턴스는 폐기합니다. 24시간 내내 적절한 수의 인스턴스만 보유한다는 뜻이죠. 고객도 만족하고 CFO도 만족하며 아키텍처에도 부담이 없습니다.

### Amazon EC2 Auto Scaling

![](https://i.imgur.com/Bb7UTiE.png)

- 애플리케이션 수요에 따라 Amazon EC2 인스턴스를 자동으로 추가하거나 제거 -> 필요에 따라 인스턴스를 자동으로 조정하여 애플리케이션 가용성을 효과적으로 유지.
    - 동적 조정 = 수요 변화에 대응
    - 예측 조정 = 예측된 수요에 따라 적절한 수의 EC2 인스턴스를 자동으로 예약
- 최소용량(Auto Scaling 그룹을 생성한 직후 시작되는 EC2 인스턴스의 수) /희망 용량 / 최대용량 설정 가능.

## 2_4. ELB (Elastic Load Balancing)
- 들어오는 애플리케이션 트래픽을 EC2 인스턴스와 같은 여러 리소스에 자동으로 분산하는 서비스
- 개별 EC2 인스턴스가 아닌 리전 수준에서 실행되므로 사용자가 추가로 작업하지 않아도 자동으로 고가용 서비스가 된다.

---

**Q. 다음 프로세스 중 Elastic Load Balancing의 예는 무엇입니까?**

1. 단일 Amazon EC2 인스턴스가 전체 워크로드를 처리하지 않아도 되도록 보장

2. 수요가 적을 때 불필요한 Amazon EC2 인스턴스 제거

3. 온라인 상점의 인기 있는 세일 기간 중 두 번째 Amazon EC2 인스턴스 추가

4. 수요에 맞춰 Amazon EC2 인스턴스 수를 자동으로 조정

A. 1

```
나머지는 모두 auto-scaling 예시
```
---

## 2_5. 메시징 및 대기열

- 밀결합된 아키텍처

![](https://i.imgur.com/IMiQ1Tp.png)

만약 계산원이 주문을 받아 바리스타에게 전달하려는데 바리스타가 쉬는 시간이거나 다른 주문으로 바쁘다면 어떻게 될까요? 계산원은 바리스타가 주문을 받을 준비가 될 때까지 기다려야 합니다. 그러면 주문 프로세스가 지연되고 고객은 주문한 음료를 받을 때까지 더 오래 기다려야 합니다.

    - 즉, 구성 요소 하나가 고장이 나거나 변경되면 다른 구성 요소나 심지어 시스템 전체에 문제
    
- 소결합된 아키텍처 : 대기열을 두자!

![](https://i.imgur.com/4cKgTUM.png)

바리스타가 쉬는 시간이거나 다른 주문으로 바쁘더라도 계산원은 계속해서 새 주문을 대기열에 넣을 수 있습니다. 

    - 메시지는 커피 주문, 주문판은 SQS 대기열
    - SNS는 메시지를 서비스에 전달하는 데 사용
    
- SNS 예시
    - 기존 :  모든 비즈니스 영역의 업데이트를 포함하는 단일 뉴스레터

![](https://i.imgur.com/z3l7kB3.png)

- 일부 고객이 관심 있는 특정 주제에 대해서만 별도의 뉴스레터를 받으면 좋겠다는 의견을 표명

![](https://i.imgur.com/PvIzTNB.png)

이제 커피숍은 모든 주제를 다루는 단일 뉴스레터 대신 이를 3개의 뉴스레터로 나눴습니다. 각 뉴스레터는 쿠폰, 커피 상식, 신제품과 같은 특정 주제만을 다룹니다.

이제 구독자는 구독한 특정 주제에 대해서만 즉시 업데이트를 받게 됩니다.


### Amazon Simple Notification Service (Amazon SNS)
게시/구독 (Pub/Sub) 서비스 ( = 커피숍에서 계산원이 음료를 만드는 바리스타에게 주문 사항을 전달하는 것 )

### Amazon Simple Queue Service (Amazon SQS)
- 메시지 대기열 서비스
- 메시지 손실이나 다른 서비스 사용 없이 소프트웨어 구성 요소 간에 메시지를 전송, 저장, 수신 가능.

---

Q. 구독자에게 메시지를 게시하는 데 가장 적합한 AWS 서비스는 무엇입니까?

A. Amazon Simple Notification Service(Amazon SNS)

---

## 2_6. 추가 컴퓨팅 서비스

### EC2 인스턴스

최소한의 손실로 프로비저닝해 AWS에서의 가동 및 실행할 수 있는 가상 머신

EC2를 사용하면 사용자가 시간에 따라 인스턴스 플릿을 `직접 설정하고 관리`해야 합니다. 또한 EC2를 사용할 때는 사용자가 새 소프트웨어 패키지가 출시되면 인스턴스 패치를 내가 직접 책임지고 인스턴스의 규모 조정을 설정하고, 솔루션이 가용성이 높은 방식으로 호스팅되도록 아키텍처를 설계했는지 확인해야 합니다.

↓

![](https://i.imgur.com/xmXWbQn.png)


AWS는 다양한 서버리스 컴퓨팅 옵션을 제공합니다. 서버리스는 애플리케이션을 호스팅하는 **기본 인프라나 인스턴스를 마치 서버가 없는 것처럼 관리할 필요가 없다는 뜻**입니다.


### 서버리스
- 애플리케이션을 호스팅하는 기본 인프라나 인스턴스를 보거나 이용할 수 없다는 뜻
- 대신 프로비저닝, 규모 조정, 고가용성 및 유지 관리와 관련한 기본 환경 관리를 대신 처리해줌.
- 관리하기 편리한 컴퓨팅 서비스, 유연성
- 서버리스 컴퓨팅용 AWS 서비스 = `AWS Lambda`
 
### AWS Lambda

![](https://i.imgur.com/ecCxXli.png)


- 서버리스 컴퓨팅 옵션의 대표 예시
- 사용한 컴퓨팅 시간에 대해서만 비용 지불 (코드를 실행하는 동안에만 요금 부과)
- 코드를 15분 미만으로 실행하도록 설계
    - 딥러닝 같은 장기 실행 프로세스에는 적합 X
    - 15분이 걸리지 않는 백엔드 요청 저리 적합 O
- Lambda는 트리거된 경우에만 코드를 실행
 
**※ 트리거란?**

"방아쇠" 라는 뜻. 방아쇠를 당기면 그로 인해 총기 내부에서 자동으로 일련의 작업을 실행하고 총알이 날아가는데, 이처럼 DB에서 트리거(Trigger)는 특정 테이블에 INSERT, DELETE, UPDATE 같은 DML 문이 수행되었을 때, DB에서 자동으로 동작하도록 작성된 프로그램. 즉, 자동적으로 호출하는 것이 가장 큰 특징!


### 컨테이너
- 애플리케이션과 관련 종속성 및 실행해야하는 모든 구성을 모아 놓은 코드 패키지
- EC2 인스턴스에서 실행되며, 가상 머신 작동 방식과 비슷하게 서로 격리되어 실행됨.
(이 경우 호스트는 EC2 인스턴스)
 

### 컨테이너 오케스트레이션
- 컨테이너 관리를 지원할 목적으로 제작
- 컨테이너화된 애플리케이션을 대규로모 실행하는 데 도움이 되도록 설계
- 예시 : Amazon Elastic Container Service / Amazon Elastic Kubernetes Service
 

### Amazon ECS(Amazon Elastic Container Service)

- 컨테이너식 애플리케이션을 실행하고 확장할 수 있는 확장성이 뛰어난 고성능 컨테이너 관리 시스템
 
- docker 컨테이너를 지원

 
### Amazon EKS(Amazon Elastic Kubernetes Service)

AWS에서 Kubernetes를 실행하는 데 사용할 수 있는 완전 관리형 서비스

### AWS Fargate
- 컨테이너용 서버리스 컴퓨팅 엔진
- Amazon ECS / EKS 에서 작동함.

---

참고 : AWS Cloud Practitioner Essentials

---
<!--stackedit_data:
eyJoaXN0b3J5IjpbODAzNjgyMDEsMTUxOTgzMDgzNiwtMTc0Nz
k4NzgyNiwxODM5NDgxNjUzXX0=
-->