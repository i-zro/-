# What I Learned
## 배포 전략

## 웹 서버
- HTTP 요청을 읽어서 응답을 해주는 프로그램
- 상용으로 많이 쓰이는 웹 서버 프로그램은 크게 apache와 nginx 있음.

### Apache vs nginx

#### 1. Apache
- 기본적으로 2가지 방식이 있음.
    - Prefork MPM(Multi Processing Module)
        - HTTP 요청이 올 때마다 프로세스 복제해서 각각 별도 프로세스에서 해당 HTTP 요청 처리
    - Worker MPM
        - 하나의 HTTP 연결 후, 여러 요청을 처리하기 위해 복제된 프로세스 내에서 여러 쓰레드를 생성해서 여러 HTTP 요청


- 아무래도 이런 방식은 프로세스를 생성하든 쓰레드를 생성하든 요청에 따라 뭔가를 생성해야한다. 더 좋은 방법이 없을까?


#### 2. Nginx
- Event Driven 방식으로 구동
    - 하나의 프로세스로 동작하며, HTTP 요청을 event로 비동기식으로 처리함.
        - 대부분의 HTTP 응답은 결국 html 파일을 제공하는 것이므로, IO 작업. IO 작업으로 event를 포워딩하고, 요청 순이 아닌, 요청이 끝난 순으로 처리함.
    - HTTP 요청마다 프로세스든 쓰레드등 생성이 필요없으므로, 시스템 자원 관리에 장점이 있음.

#### 결론
Apache와 nginx 중 HTML 파일 사이즈, 어떤 추가 기능을 쓰느냐 등 다양한 조건 때문에 무엇이 더 무조건 성능이 좋다고는 이야기 할 수 없음. 하지만 많은 접속자가 있을 경우, 시스템 자원 관리 효율성 때문에 Nginx가 일반적으로는 성능이 더 좋을 수 있으므로 해당 프로젝트에서는 Nginx를 사용함.

## 도커
### 도커란?
다양한 운영체제와 시스템 환경에서 서버 셋업을 위한 작업이 모두 다르고 복잡.

도커는 컨테이너 기반의 가상화 플랫폼이라서, 컨테이너 상에 서버를 셋업 해놓을 수 있음. 

그래서 컨테이너를 실행만 하면, 서버 이전이나 서버 패키지 버전 등등으로 일일이 서버 설정할 필요없이, 동일한 서버 셋업 가능.



# 결과

### 계정 기초보안
루트계정의 Access Key를 탈취하여 고비용의 리소스를 생성하거나 고비용의 서비스를 신청하여 단기간에 수만 달러에 달하는 비용을 발생시키는 피해가 발생하므로, 꼭 추가 보안 설정이 필요함.

1. 루트 사용자 MFA 설정

AWS 콘솔에 로그인할 때 아이디/패스워드 외 추가 인증을 더하는 것

2. 루트 사용자 Access Key 삭제

액세스 키는 아이디/패스워드 인증과 동일한 권한을 갖지만 AWS CLI, PowerShell용 도구, AWS SDK 또는 직접 AWS API 호출을 통해 AWS를 프로그래밍 방식으로 호출할 수 있도록 해주는 반드시 필요한 존재이지만 액세스 키가 루트 사용자 권한으로 사용될 때는 그 용도 만큼이나 매우 강력해서 탈취되어 악용하면 광범위한 영역에서 피해를 줄 수 있음. 따라서, 특별한 이유가 없다면 루트 사용자 계정에는 반드시 액세스 키를 삭제하거나 비활성화되어 있어야 함.

3. IAM 사용자 설정

`admin` 사용자를 따로 만들어 AdministratorAccess 권한만 부여. 이렇게 빌링 권한을 가지지 않은 사용자를 이용하여, AWS 리소스에 대한 액세스를 안전하게 제어.

### 웹 서버 - Nginx
Apache와 nginx 중 HTML 파일 사이즈, 어떤 추가 기능을 쓰느냐 등 다양한 조건 때문에 무엇이 더 무조건 성능이 좋다고는 이야기 할 수 없음. 하지만 많은 접속자가 있을 경우, 시스템 자원 관리 효율성 때문에 Nginx가 일반적으로는 성능이 더 좋을 수 있으므로 해당 프로젝트에서는 Nginx를 사용함.

### 배포 전략



<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE5Njk0NDMzNDNdfQ==
-->